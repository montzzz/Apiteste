databaseChangeLog:
- changeSet:
    id: issue24
    author: Roberto
    comment: Tabelas do gerador de relatÃ³rios
    changes:
    - createTable:
        columns:
        - column:
            constraints:
              nullable: false
            name: ID
            type: VARCHAR(36)
        - column:
            constraints:
              nullable: false
            name: REPORT_ID
            type: VARCHAR(50)
        - column:
            constraints:
              nullable: false
            name: USERNAME
            type: VARCHAR(50)
        - column:
            constraints:
              nullable: false
            name: ACTIVE
            type: SMALLINT
        - column:
            constraints:
              nullable: false
            name: RUN_ONCE
            type: SMALLINT
        - column:
            constraints:
              nullable: false
            name: DELETE_AFTER_EXECUTION
            type: SMALLINT
        - column:
            constraints:
              nullable: false
            name: CRON
            type: VARCHAR(50)
        - column:
            name: LAST_EXECUTION
            type: TIMESTAMP
        - column:
            constraints:
              nullable: false
            name: EMAILS
            type: BLOB SUB_TYPE TEXT
        - column:
            name: PARAMETERS
            type: BLOB SUB_TYPE TEXT
        - column:
            name: BODY
            type: BLOB SUB_TYPE TEXT
        - column:
            name: SCRIPT
            type: BLOB SUB_TYPE TEXT
        - column:
            constraints:
              nullable: false
            name: SUBJECT
            type: VARCHAR(50)
        - column:
            name: REPORT_PARAMETER_STORAGE_ID
            type: VARCHAR(36)
        - column:
            name: LAST_EXECUTION_DETAILS
            type: BLOB SUB_TYPE TEXT
        - column:
            name: LAST_EXECUTION_SUCCESS
            type: SMALLINT
        tableName: B_REPORT_SCHEDULE
    - createIndex:
        columns:
        - column:
            name: REPORT_ID
        - column:
            name: USERNAME
        indexName: IDX_BREPSCHURPTSR
        tableName: B_REPORT_SCHEDULE
        unique: false
    - addPrimaryKey:
        columnNames: ID
        constraintName: PK_BREPSCH
        tableName: B_REPORT_SCHEDULE
    - createTable:
        columns:
        - column:
            constraints:
              nullable: false
            name: ID
            type: VARCHAR(36)
        - column:
            constraints:
              nullable: false
            name: REPORT_ID
            type: VARCHAR(50)
        - column:
            constraints:
              nullable: false
            name: NAME
            type: VARCHAR(50)
        - column:
            constraints:
              nullable: false
            name: USERNAME
            type: VARCHAR(50)
        - column:
            constraints:
              nullable: false
            name: PARAMETERS
            type: BLOB SUB_TYPE TEXT
        tableName: B_REPORT_PARAM_STORAGE
    - addPrimaryKey:
        columnNames: ID
        constraintName: PK_BREPPRMSTO
        tableName: B_REPORT_PARAM_STORAGE
    - createIndex:
        columns:
        - column:
            name: NAME
        - column:
            name: USERNAME
        - column:
            name: REPORT_ID
        indexName: IDX_BREPPRMSTORPT
        tableName: B_REPORT_PARAM_STORAGE
        unique: true
    - addForeignKeyConstraint:
        baseColumnNames: REPORT_PARAMETER_STORAGE_ID
        baseTableName: B_REPORT_SCHEDULE
        constraintName: FK_BREPSCH_BREPPRMSTO
        deferrable: false
        initiallyDeferred: false
        onDelete: NO ACTION
        onUpdate: NO ACTION
        referencedColumnNames: ID
        referencedTableName: B_REPORT_PARAM_STORAGE
- changeSet:
    id: issue53
    author: Roberto
    comment: Fix firebird 2.1 column name active
    changes:
    - renameColumn:
        newColumnName: ACTIVATE
        oldColumnName: ACTIVE
        columnDataType: SMALLINT
        tableName: B_REPORT_SCHEDULE
- changeSet:
    id: issue45
    author: Roberto
    comment: Coluna para marcar lista de parametros padrao
    changes:
    - addColumn:
        columns:
        - column:
            name: STANDARD
            type: SMALLINT
        tableName: B_REPORT_PARAM_STORAGE
- changeSet:
    id: issue45_part2
    author: Roberto
    comment: Indice das listas de parametros do relatorio por usuario
    changes:
    - sql:
        splitStatements: true
        sql: >
          create index IDX_BREPPRMSTO_NAME on B_REPORT_PARAM_STORAGE computed by (upper(NAME));
          create index IDX_BREPPRMSTO_USERNAME on B_REPORT_PARAM_STORAGE computed by (upper(USERNAME));
          create index IDX_BREPPRMSTO_REPORTID on B_REPORT_PARAM_STORAGE computed by (upper(REPORT_ID));